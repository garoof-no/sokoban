<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Sokoboko</title>
  <link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJCAYAAADgkQYQAAAAAXNSR0IArs4c6QAAAGFJREFUGJWNkFEKwCAMQx+yUwj7Ejxcvz3Gvr2g4DWyHztkc2yB0pCEBkpOCUBjryAAFTMB2mO8nMEFKLhYzGi9y43Wu4oZANt818U7wlL9Ch21PvgjNFc6/1WH/+ltckqcRpYkzQ6QhCcAAAAASUVORK5CYII=" sizes="any" type="image/png">
  <script>
  
const elem = (tagName, props, ...children) => {
  const el = Object.assign(document.createElement(tagName), props);
  el.replaceChildren(...children);
  return el;
};
let sprites;
let spritesImg;

const vecs = new Map();
const vec = (x, y) => {
  const key = `${x},${y}`;
  if (!vecs.has(key)) {
    vecs.set(key, { x: x, y: y });
  }
  return vecs.get(key);
}

const tileSize = vec(32, 32);
const keySize = vec(48, 48);

const add = (a, b) => vec(a.x + b.x, a.y + b.y);
const neg = (v) => vec(-v.x, -v.y);

const trimmed = (str) => str.match(/^\n*([\s\S]*?)\n*$/)[1];

const levelformat = {
  read: str => {
    const rows = trimmed(str).split("\n").map((x) => x.trimEnd().split(""));
    const size = vec(Math.max(...rows.map(row => row.length)), rows.length);
    for (const row of rows) {
      while (row.length < size.x) {
        row.push(" ");
      }
    }
    return { rows: rows, size: size };
  },
  write: level =>
    trimmed(level.rows.map(row => row.join("").trimEnd()).join("\n"))
};

const newGame = str => {
  const level = levelformat.read(str);
  return {
    level: level,
    moves: "",
    redo: "",
    won: won(level)
  };
};

const levelpack = {
  read: str => {
    const res = { meta: new Map(), levels: [] };

    let current = null;

    const kv = (key, value) => {
      const o = current || res;
      if (o.meta.has(key)) {
        console.error(`not adding duplicate key: ${key} => ${value}`);
      } else {
      o.meta.set(key, value);
      }
    };

    const row = (str) => {
      if (current === null || current.meta.size > 0) {
        current = { meta: new Map(), content: "" };
        res.levels.push(current);
      }
      if (current.content !== "") {
        current.content += "\n";
      }
      current.content += str;
    };
  
    for (const line of str.split("\n")) {
      const l = line.trimEnd();
      if (l === "") {
        current = null;
      } else {
        const i = l.indexOf(":");
        if (i >= 0) {
          kv(l.substring(0, i), l.substring(i + 1).trim());
        } else {
          row(l);
        }
      }
    }
    return res;
  },
  write: pack => {
    let str = "";
    for ([k, v] of pack.meta) {
      str += `${k}: ${v}\n`;
    }
    str += "\n";
    for (const level of pack.levels) {
      str += `${level.content}\n`;
      for (const [k, v] of level.meta) {
        str += `${k}: ${v}\n`;
      }
      str += "\n";
    }
    return str;
  }
};

let pack;
let levelIdx;

const htmlString = () => {
  const levels = elem("pre", { id: "levels" }, levelpack.write(pack)).outerHTML;
  return `<!DOCTYPE html>
<html lang="en">
${document.head.outerHTML}
<body>
  <h1>Sokoboko</h1>
  <div id="game"></div>
  ${spritesImg.outerHTML}
  ${levels}
</body>
</html>
`;
};

const metaHtml = (m) => {
  const title = m.has("Title") ? m.get("Title")  : "untitled";
  const res = [elem("h2", {}, title)];
  if (m.has("Description")) {
    res.push(elem("p", {}, m.get("Description")));
  }
  let ul = null;
  for ([k, v] of m) {
    if (k !== "Title" && k !== "Description" && !k.startsWith("State.")) {
      if (ul === null) {
         ul = elem("ul", {});
         res.push(ul);
      }
      ul.appendChild(elem("li", {}, `${k}: ${v}`));
    }
  }
  return res;
};

const download = (filename, text) => {
    const href = `data:text/plain;charset=utf-8,${encodeURIComponent(text)}`;
    elem("a", { href: href, download: filename }).click();
};

const packHtml = (pack, selectLevel) => {  
  const res = metaHtml(pack.meta);
  res.push(elem("h3", {}, `${pack.levels.length} levels`));
  const p = elem("p");
  res.push(p);
  pack.levels.forEach((level, i) => {
    const title = level.meta.get("Title");
    const n = i + 1;
    const titleStr = title === null || title === `${n}` ? "" : `: ${title}`;
    const solved = level.meta.has("State.Solution") ? " :)" : "";
    const button = elem(
      "button",
      { onclick: () => selectLevel(i) },
      `Level ${i + 1}${titleStr}${solved}`
    );
    p.appendChild(button);
  });
  res.push(elem(
    "button",
    { onclick: () => download("sokoboko.html", htmlString()) },
    "ðŸ’¾ .HTML"
  ));
  res.push(elem(
    "button",
    { onclick: () => download("sokoboko.txt", levelpack.write(pack)) },
    "ðŸ’¾ .TXT"
  ));
  return res;
};

const url = (() => {
  const a = [" ", "#", ".", "@", "+", "$", "*", "\n"];
  const alphabet =
    "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";
  return {
    read: (str) => {
      let res = "";
      for (const c of str) {
        const b = alphabet.indexOf(c)
        if (b >= 0) {
          const first = b >>> 3;
          res += a[first];
          const second = b & 0b111;
          res += a[second];
        } else {
          res += "  ";
        }
      }
      return res;
    },
    write: (str) => {
      let res = "";
      for (let i = 0; i < str.length; i+= 2) {
        let b = 0;
        const first = a.indexOf(str[i]);
        if (first >= 0) {
          b = first << 3;
        }
        if (i + 1 < str.length) {
          const second = a.indexOf(str[i + 1]);
          if (second >= 0) {
            b += second;
          }
        }
        res += alphabet[b];
      }
      return res;
    }
  };
})();

const style = (bc, hc, ac) => `
body {
  background-color: lightgrey;
}
button.tile {
  padding: 0;
  margin: 0;
  width: ${tileSize.x}px;
  height: ${tileSize.y}px;
  display: inline-block; border-style: none;
  background-color: ${bc};
}
button.key {
  width: ${keySize.x}px;
  height: ${keySize.y}px;
}
button.tile:hover {
  background-color: ${hc};
}
button.tile:active, button.active {
  background-color: ${ac};
}
button.tile img {
  mix-blend-mode: multiply;
}
pre.moves {
  white-space: pre-wrap;
  word-break: break-all;
}
.hidden {
  display: none;
}
`;

const at = (level, pos, notfound = "#") => {
  if (
    pos.y < 0 || pos.y >= level.size.y
    || pos.x < 0 || pos.x >= level.size.x
  ) {
    return notfound;
  }
  return level.rows[pos.y][pos.x];
};

const won = (level) =>
  !level.rows.some((row) => row.some((tile) => tile === "." || tile === "+"));

const put = (level, pos, tile) => (level.rows[pos.y][pos.x] = tile);

const playerPos = (level) => {
  for (let y = 0; y < level.size.y; y++) {
    const row = level.rows[y];
    for (let x = 0; x < level.size.x; x++) {
      const tile = row[x];
      if (tile === "@" || tile === "+") {
        return vec(x, y);
      }
    }
  }
  throw "no player in level? :(";
};

const player = ["@", "+"];
const box = ["$", "*"];

const step = (level, type, pos, dir) => {
  const tile = at(level, pos);
    if (tile !== type[0] && tile !== type[1]) {
    return false;
  }
  
  const nextPos = add(pos, dir);
  const nextTile = at(level, nextPos);
  if (nextTile !== " " && nextTile !== ".") {
    return false;
  }
  put(level, pos, tile === type[0] ? " " : ".");
  put(level, nextPos, nextTile === " " ? type[0] : type[1]);
  return true;
};

const dirs = [
  { name: "u", vec: vec(0, -1) },
  { name: "l", vec: vec(-1, 0) },
  { name: "d", vec: vec(0, 1) },
  { name: "r", vec: vec(1, 0) }
];
const dirNum = (str) => {
  const s = str.toLowerCase();
  return s === "u" ? 0 : s === "l" ? 1 : s === "d" ? 2 : s === "r" ? 3 : false;
};


const move = (game, letter) => {
  if (game.won) {
    return;
  }
  const dir = dirs[dirNum(letter)];
  const pos = playerPos(game.level);
  const boxMoved = step(game.level, box, add(pos, dir.vec), dir.vec);
  const playerMoved = step(game.level, player, pos, dir.vec);
  const moveMade = boxMoved
    ? dir.name.toUpperCase()
    : playerMoved
    ? dir.name
    : "";
  game.moves += moveMade;
  game.redo = "";
  game.won = won(game.level);
};

const undo = (game) => {
  if (game.moves === "") {
    return;
  }
  const pos = playerPos(game.level);
  const moveMade = game.moves.slice(-1);
  const forward = dirs[dirNum(moveMade)].vec;
  const back = neg(forward);
  if (!step(game.level, player, pos, back)) {
    throw "player won't move back :(";
  }

  if (moveMade === moveMade.toUpperCase()) {
    if (!step(game.level, box, add(pos, forward), back)) {
      throw "box won't move back :(";
    }
  }
  game.moves = game.moves.slice(0, -1);
  game.redo = moveMade + game.redo;
  game.won = won(game.level);
};

const restart = (game) => {
  while (game.moves !== "") {
    undo(game);
  }
};

const redo = (game) => {
  if (game.redo === "") {
    return;
  }
  const moveMade = game.redo.slice(0, 1);
  const newRedo = game.redo.slice(1);
  move(game, moveMade);
  game.redo = newRedo;
};

const makeSprites = (img) => {
  const canvas = document.body.appendChild(elem("canvas"));
  const ctx = canvas.getContext("2d");;
  canvas.width = tileSize.x;
  canvas.height = tileSize.y;
  ctx.imageSmoothingEnabled = false;

  sprites = new Map(
    [
      [" ", vec(0, 0)], [".", vec(1, 0)],
      ["$", vec(0, 1)], ["*", vec(1, 1)],
      ["@", vec(0, 2)], ["+", vec(1, 2)],
      ["#", vec(0, 3)], ["X", vec(1, 3)],
    ].map((a) => {
      const { x: w, y: h } = tileSize;
      ctx.drawImage(img, a[1].x * 16, a[1].y * 16, 16, 16, 0, 0, w, h);
      return [a[0], canvas.toDataURL()];
    })
  );
  canvas.remove();
};

const img = (tile) =>
  elem("img", { src: sprites.get(tile), alt: "" });

const button = (tile) => elem("button", { className: "tile" }, img(tile));

const tilemap = () => elem("pre", { style: "line-height: 0;" });

const firstUnsolved = pack => {
  let i;
  for (i = 0; i < pack.levels.length; i++) {
    if (!pack.levels[i].meta.has("State.Solution")) {
      return i;
    }
  }
  return i;
};

const play = () => {
  let game;
  let selectLevel;
  let touch = false;
  levelIdx = firstUnsolved(pack);

  const gameEl = document.querySelector("#game");
  gameEl.replaceChildren();
  gameEl.appendChild(elem("style", {}, style("#AAAAAA", "#888888", "#444444")));
  const levelMeta = gameEl.appendChild(elem("div"));
  gameEl.appendChild(elem("hr"));
  const gamePre = gameEl.appendChild(tilemap());
  const snapshotEl = gameEl.appendChild(elem("pre", { className: "moves" }));
  const solutionEl = gameEl.appendChild(elem("pre"));
  const wonEl = gameEl.appendChild(elem("p"));
  const controlsEl = gameEl.appendChild(elem("table"));
  gameEl.appendChild(elem("hr"));
  const packMeta = gameEl.appendChild(elem("div"));

  let draw;

  const showSolution = () => {
    const meta = pack.levels[levelIdx].meta;
    if (meta.has("State.Solution")) {
      const solution = meta.get("State.Solution");
      solutionEl.className = "moves";
      solutionEl.innerText = `Solution:\n${solution}\n`
      solutionEl.appendChild(elem(
        "button",
        {
          onclick: () => {
            restart(game);
            for (const c of solution) {
              move(game, c);              
            }
            draw();
          }
        },
        "Load solution"
      ));
      
    } else {
      solutionEl.className = "hidden";
    }
  };

  const descriptions = {
    w: "Up",
    a: "Left",
    s: "Down",
    d: "Right",
    z: "Undo",
    y: "Redo",
    r: "Restart"
  };

  const perform = (() => {
    const commands = new Map([
      ["w", () => move(game, "u")],
      ["a", () => move(game, "l")],
      ["s", () => move(game, "d")],
      ["d", () => move(game, "r")],
      ["z", () => undo(game)],
      ["y", () => redo(game)],
      ["r", () => restart(game)],
    ]);
    return (c) => () => {
      if (commands.has(c)) {
        commands.get(c)();
        const meta = pack.levels[levelIdx].meta;
        meta.set("State.Snapshot", game.moves);
        if (game.won) {
          meta.set("State.Solution", game.moves);
          showSolution();
          packMeta.replaceChildren(...packHtml(pack, selectLevel));
        }
        draw();
      }
    };
  })();

  (() => {
  
    const layout = `
 w r y t
asd
z
`.split("\n").map((x) => x.split(""));
    layout.pop();
    layout.shift();
    for (const row of layout) {
      const tr = controlsEl.appendChild(elem("tr"));
      for (const c of row) {
        const td = tr.appendChild(elem("td"));
        if (c === "t") {
          td.appendChild(elem(
            "button",
            {
              style: `height: ${keySize.y}px;`,
              onclick: () => { touch = !touch; draw(); }
            },
            "Toggle particularly good touch controls!"
          ));
        } else if (c !== " ") {
          td.appendChild(elem(
            "button",
            {
              className: "key",
              title: descriptions[c],
              onclick: perform(c)
            },
            c.toUpperCase()
          ));
        }
      }
    }
  })();

  selectLevel = i => {
    levelIdx = i;
    const level = pack.levels[levelIdx];
    game = newGame(level.content);
    if (level.meta.has("State.Snapshot")) {
      for (const c of level.meta.get("State.Snapshot")) {
        move(game, c);
      }
    }
    levelMeta.replaceChildren(...metaHtml(level.meta));
    solutionEl.replaceChildren();
    draw();
  };

  draw = () => {
    snapshotEl.innerText = game.moves === "" ? "..." : game.moves;
    wonEl.innerText = game.won ? "Yay!" : "...";

    gamePre.replaceChildren();
    const player = playerPos(game.level);
    const buttons = new Map(
      [
        [add(player, vec(0, -1)), "w"],
        [add(player, vec(-1, 0)), "a"],
        [add(player, vec(0, 1)), "s"],
        [add(player, vec(1, 0)), "d"]
      ]
    );
    game.level.rows.forEach((row, y) => {
      row.forEach((tile, x) => {
        const pos = vec(x, y);
        if (touch && buttons.has(pos)) {
          const command = buttons.get(pos);
          const btn = gamePre.appendChild(button(tile));
          btn.title = `${descriptions[command]} (${command})`;
          btn.onclick = perform(command);
        } else {
          gamePre.appendChild(img(tile));
        }
      });
      gamePre.appendChild(elem("br"));
      showSolution();
    });
  };

  packMeta.replaceChildren(...packHtml(pack, selectLevel));
  document.onkeypress = event => perform(event.key.toLowerCase())();
  selectLevel(levelIdx);
};

window.onload = () => {

  const levelsEl = document.querySelector("#levels");
  pack = levelpack.read(levelsEl.innerText);
  levelsEl.remove();
  spritesImg = document.querySelector("#sprites");
  spritesImg.remove()
  makeSprites(spritesImg);

  const params = new URLSearchParams(location.search);
  const urlLevel = params.get("level");
  if (urlLevel !== null) {
    try {
      pack = levelpack.read(url.read(urlLevel));
    } catch (e) {
      console.error(e);
    }
  }
  play();
};
  </script>
</head>
<body>
  <h1>Sokoboko</h1>
  <div id="game"></div>
  <img id="sprites" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAABACAYAAAB7jnWuAAAAAXNSR0IArs4c6QAAAkRJREFUaIHtmLFuwjAQhi9R3gCpU9duOANrFyamqM+BssIrdCsrYu0LdGJi4gkYcB+BCYlXSDpdcIzPvjhXsuSXkEKc+P/OdxccEq11DQMqHdJ8BBgBRoARYAQAAMgkJlFKRd2ntZYB0FpH3zt4CkYAsgZWh2nr+2bx+xwANC7yCgAA9ucUirxqzkuDtFKwOkwbY1tFXrVAxAFM8yKvYH9OH47xuyREawX259RpbB6bMBJKtNa1vfSY99CxRD00RWhHZkZvm3PE7aIGwDe5HTnHmNtFwYS6UkDBxnRRgm9G9gAWHjf/3Dqy72+tAFL6zH2K6aJksalrpDGjQFMfParPfqBpQ1uuVQCQfxQn1Nvxs36MSIBnafD9gBfAV1yxhccGUErBuiydRlxzTgDBFCCE+VmXJcucEwBrW84x9N1rQ6zLEr622zYAXtRnj++DoJSieShKJLaPUZiermK3oQlow/YJ4AEgNpKQqAAy6iIA91KjqFrpCu/tAmpZKbCYAETejilxAhAD8EXrklKK/n/ANZmvyvs8OzKcwCwe14Sh8VgNvh9IPt+gF8DrywQAAGa7Y6f7Tsv5HQAncelyvYFv3BQXAs0BBHZEpqk5Mcd8tjvKbMm4ELY5gEANfPzcO8JlEBpLvt8nLYBQzu1xjpEPTHxXbKfDZ/4vAJQR1SHZ5Xp7OOk6R43POqE5AACgU845cnXCaTl/TgrsnIdaVBSAKjgfhNhzIFTt1DUizwGOOQXROwVdzO1rTsu5XA10+Tk2r/0DrneQqwh5DMcAAAAASUVORK5CYII=" alt="">
  <pre id="levels">
Title: Original
Description: The 50 original levels from Sokoban.
Author: Thinking Rabbit

    #####
    #   #
    #$  #
  ###  $##
  #  $ $ #
### # ## #   ######
#   # ## #####  ..#
# $  $          ..#
##### ### #@##  ..#
    #     #########
    #######
Title: 1

############
#..  #     ###
#..  # $  $  #
#..  #$####  #
#..    @ ##  #
#..  # #  $ ##
###### ##$ $ #
  # $  $ $ $ #
  #    #     #
  ############
Title: 2

        ########
        #     @#
        # $#$ ##
        # $  $#
        ##$ $ #
######### $ # ###
#....  ## $  $  #
##...    $  $   #
#....  ##########
########
Title: 3

           ########
           #  ....#
############  ....#
#    #  $ $   ....#
# $$$#$  $ #  ....#
#  $     $ #  ....#
# $$ #$ $ $########
#  $ #     #
## #########
#    #    ##
#     $   ##
#  $$#$$  @#
#    #    ##
###########
Title: 4

        #####
        #   #####
        # #$##  #
        #     $ #
######### ###   #
#....  ## $  $###
#....    $ $$ ##
#....  ##$  $ @#
#########  $  ##
        # $ $  #
        ### ## #
          #    #
          ######
Title: 5

######  ###
#..  # ##@##
#..  ###   #
#..     $$ #
#..  # # $ #
#..### # $ #
#### $ #$  #
   #  $# $ #
   # $  $  #
   #  ##   #
   #########
Title: 6

       #####
 #######   ##
## # @## $$ #
#    $      #
#  $  ###   #
### #####$###
# $  ### ..#
# $ $ $ ...#
#    ###...#
# $$ # #...#
#  ### #####
####
Title: 7

  ####
  #  ###########
  #    $   $ $ #
  # $# $ #  $  #
  #  $ $  #    #
### $# #  #### #
#@#$ $ $  ##   #
#    $ #$#   # #
#   $    $ $ $ #
#####  #########
  #      #
  #      #
  #......#
  #......#
  #......#
  ########
Title: 8

          #######
          #  ...#
      #####  ...#
      #      . .#
      #  ##  ...#
      ## ##  ...#
     ### ########
     # $$$ ##
 #####  $ $ #####
##   #$ $   #   #
#@ $  $    $  $ #
###### $$ $ #####
     #      #
     ########
Title: 9

 ###  #############
##@####       #   #
# $$   $$  $ $ ...#
#  $$$#    $  #...#
# $   # $$ $$ #...#
###   #  $    #...#
#     # $ $ $ #...#
#    ###### ###...#
## #  #  $ $  #...#
#  ## # $$ $ $##..#
# ..# #  $      #.#
# ..# # $$$ $$$ #.#
##### #       # #.#
    # ######### #.#
    #           #.#
    ###############
Title: 10

          ####
     #### #  #
   ### @###$ #
  ##      $  #
 ##  $ $$## ##
 #  #$##     #
 # # $ $$ # ###
 #   $ #  # $ #####
####    #  $$ #   #
#### ## $         #
#.    ###  ########
#.. ..# ####
#...#.#
#.....#
#######
Title: 11

################
#              #
# # ######     #
# #  $ $ $ $#  #
# #   $@$   ## ##
# #  $ $ $###...#
# #   $ $  ##...#
# ###$$$ $ ##...#
#     # ## ##...#
#####   ## ##...#
    #####     ###
        #     #
        #######
Title: 12

   #########
  ##   ##  ######
###     #  #    ###
#  $ #$ #  #  ... #
# # $#@$## # #.#. #
#  # #$  #    . . #
# $    $ # # #.#. #
#   ##  ##$ $ . . #
# $ #   #  #$#.#. #
## $  $   $  $... #
 #$ ######    ##  #
 #  #    ##########
 ####
Title: 13

       #######
 #######     #
 #     # $@$ #
 #$$ #   #########
 # ###......##   #
 #   $......## # #
 # ###......     #
##   #### ### #$##
#  #$   #  $  # #
#  $ $$$  # $## #
#   $ $ ###$$ # #
#####     $   # #
    ### ###   # #
      #     #   #
      ########  #
             ####
Title: 14

   ########
   #   #  #
   #  $   #
 ### #$   ####
 #  $  ##$   #
 #  # @ $ # $#
 #  #      $ ####
 ## ####$##     #
 # $#.....# #   #
 #  $..**. $# ###
##  #.....#   #
#   ### #######
# $$  #  #
#  #     #
######   #
     #####
Title: 15

#####
#   ##
#    #  ####
# $  ####  #
#  $$ $   $#
###@ #$    ##
 #  ##  $ $ ##
 # $  ## ## .#
 #  #$##$  #.#
 ###   $..##.#
  #    #.*...#
  # $$ #.....#
  #  #########
  #  #
  ####
Title: 16

   ##########
   #..  #   #
   #..      #
   #..  #  ####
  #######  #  ##
  #            #
  #  #  ##  #  #
#### ##  #### ##
#  $  ##### #  #
# # $  $  # $  #
# @$  $   #   ##
#### ## #######
   #    #
   ######
Title: 17

     ###########
     #  .  #   #
     # #.    @ #
 ##### ##..# ####
##  # ..###     ###
# $ #...   $ #  $ #
#    .. ##  ## ## #
####$##$# $ #   # #
  ## #    #$ $$ # #
  #  $ # #  # $## #
  #               #
  #  ###########  #
  ####         ####
Title: 18

  ######
  #   @####
##### $   #
#   ##    ####
# $ #  ##    #
# $ #  ##### #
## $  $    # #
## $ $ ### # #
## #  $  # # #
## # #$#   # #
## ###   # # ######
#  $  #### # #....#
#    $    $   ..#.#
####$  $# $   ....#
#       #  ## ....#
###################
Title: 19

    ##########
#####        ####
#     #   $  #@ #
# #######$####  ###
# #    ## #  #$ ..#
# # $     #  #  #.#
# # $  #     #$ ..#
# #  ### ##     #.#
# ###  #  #  #$ ..#
# #    #  ####  #.#
# #$   $  $  #$ ..#
#    $ # $ $ #  #.#
#### $###    #$ ..#
   #    $$ ###....#
   #      ## ######
   ########
Title: 20

#########
#       #
#       ####
## #### #  #
## #@##    #
# $$$ $  $$#
#  # ## $  #
#  # ##  $ ####
####  $$$ $#  #
 #   ##   ....#
 # #   # #.. .#
 #   # # ##...#
 ##### $  #...#
     ##   #####
      #####
Title: 21

######     ####
#    #######  #####
#   $#  #  $  #   #
#  $  $  $ # $ $  #
##$ $   # @# $    #
#  $ ########### ##
# #   #.......# $#
# ##  # ......#  #
# #   $........$ #
# # $ #.... ..#  #
#  $ $####$#### $#
# $   ### $   $  ##
# $     $ $  $    #
## ###### $ ##### #
#         #       #
###################
Title: 22

    #######
    #  #  ####
##### $#$ #  ##
#.. #  #  #   #
#.. # $#$ #  $####
#.  #     #$  #  #
#..   $#  # $    #
#..@#  #$ #$  #  #
#.. # $#     $#  #
#.. #  #$$#$  #  ##
#.. # $#  #  $#$  #
#.. #  #  #   #   #
##. ####  #####   #
 ####  ####   #####
Title: 23

###############
#..........  .####
#..........$$.#  #
###########$ #   ##
#      $  $     $ #
## ####   #  $ #  #
#      #   ##  # ##
#  $#  # ##  ### ##
# $ #$###    ### ##
###  $ #  #  ### ##
###    $ ## #  # ##
 # $  #  $  $ $   #
 #  $  $#$$$  #   #
 #  #  $      #####
 # @##  #  #  #
 ##############
Title: 24

####
#  ##############
#  #   ..#......#
#  # # ##### ...#
##$#    ........#
#   ##$######  ####
# $ #     ######@ #
##$ # $   ######  #
#  $ #$$$##       #
#      #    #$#$###
# #### #$$$$$    #
# #    $     #   #
# #   ##        ###
# ######$###### $ #
#        #    #   #
##########    #####
Title: 25

 #######
 #  #  #####
##  #  #...###
#  $#  #...  #
# $ #$$ ...  #
#  $#  #... .#
#   # $########
##$       $ $ #
##  #  $$ #   #
 ######  ##$$@#
      #      ##
      ########
Title: 26

 #################
 #...   #    #   ##
##.....  $## # #$ #
#......#  $  #    #
#......#  #  # #  #
######### $  $ $  #
  #     #$##$ ##$##
 ##   $    # $    #
 #  ## ### #  ##$ #
 # $ $$     $  $  #
 # $    $##$ ######
 #######  @ ##
       ######
Title: 27

         #####
     #####   #
    ## $  $  ####
##### $  $ $ ##.#
#       $$  ##..#
#  ###### ###.. #
## #  #    #... #
# $   #    #... #
#@ #$ ## ####...#
####  $ $$  ##..#
   ##  $ $  $...#
    # $$  $ #  .#
    #   $ $  ####
    ######   #
         #####
Title: 28

#####
#   ##
# $  #########
## # #       ######
## #   $#$#@  #   #
#  #      $ #   $ #
#  ### ######### ##
#  ## ..*..... # ##
## ## *.*..*.* # ##
# $########## ##$ #
#  $   $  $    $  #
#  #   #   #   #  #
###################
Title: 29

       ###########
       #   #     #
#####  #     $ $ #
#   ##### $## # ##
# $ ##   # ## $  #
# $  @$$ # ##$$$ #
## ###   # ##    #
## #   ### #####$#
## #     $  #....#
#  ### ## $ #....##
# $   $ #   #..$. #
#  ## $ #  ##.... #
#####   ######...##
    #####    #####
Title: 30

  ####
  #  #########
 ##  ##  #   #
 #  $# $@$   ####
 #$  $  # $ $#  ##
##  $## #$ $     #
#  #  # #   $$$  #
# $    $  $## ####
# $ $ #$#  #  #
##  ###  ###$ #
 #  #....     #
 ####......####
   #....####
   #...##
   #...#
   #####
Title: 31

      ####
  #####  #
 ##     $#
## $  ## ###
#@$ $ # $  #
#### ##   $#
 #....#$ $ #
 #....#   $#
 #....  $$ ##
 #... # $   #
 ######$ $  #
      #   ###
      #$ ###
      #  #
      ####
Title: 32

############
##     ##  #
##   $   $ #
#### ## $$ #
#   $ #    #
# $$$ # ####
#   # # $ ##
#  #  #  $ #
# $# $#    #
#   ..# ####
####.. $ #@#
#.....# $# #
##....#  $ #
###..##    #
############
Title: 33

 #########
 #....   ##
 #.#.#  $ ##
##....# # @##
# ....#  #  ##
#     #$ ##$ #
## ###  $    #
 #$  $ $ $#  #
 # #  $ $ ## #
 #  ###  ##  #
 #    ## ## ##
 #  $ #  $  #
 ###$ $   ###
   #  #####
   ####
Title: 34

############ ######
#   #    # ###....#
#   $$#   @  .....#
#   # ###   # ....#
## ## ###  #  ....#
 # $ $     # # ####
 #  $ $##  #      #
#### #  #### # ## #
#  # #$   ## #    #
# $  $  # ## #   ##
# # $ $    # #   #
#  $ ## ## # #####
# $$     $$  #
## ## ### $  #
 #    # #    #
 ###### ######
Title: 35

            #####
#####  ######   #
#   ####  $ $ $ #
# $   ## ## ##  ##
#   $ $     $  $ #
### $  ## ##     ##
  # ##### #####$$ #
 ##$##### @##     #
 # $  ###$### $  ##
 # $  #   ###  ###
 # $$ $ #   $$ #
 #     #   ##  #
 #######.. .###
    #.........#
    #.........#
    ###########
Title: 36

###########
#......   #########
#......   #  ##   #
#..### $    $     #
#... $ $ #   ##   #
#...#$#####    #  #
###    #   #$  #$ #
  #  $$ $ $  $##  #
  #  $   #$#$ ##$ #
  ### ## #    ##  #
   #  $ $ ## ######
   #    $  $  #
   ##   # #   #
    #####@#####
        ###
Title: 37

      ####
####### @#
#     $  #
#   $## $#
##$#...# #
 # $...  #
 # #. .# ##
 #   # #$ #
 #$  $    #
 #  #######
 ####
Title: 38

             ######
 #############....#
##   ##     ##....#
#  $$##  $ @##....#
#      $$ $#  ....#
#  $ ## $$ # # ...#
#  $ ## $  #  ....#
## ##### ### ##.###
##   $  $ ##   .  #
# $###  # ##### ###
#   $   #       #
#  $ #$ $ $###  #
# $$$# $   # ####
#    #  $$ #
######   ###
     #####
Title: 39

    ############
    #          ##
    #  # #$$ $  #
    #$ #$#  ## @#
   ## ## # $ # ##
   #   $ #$  # #
   #   # $   # #
   ## $ $   ## #
   #  #  ##  $ #
   #    ## $$# #
######$$   #   #
#....#  ########
#.#... ##
#....   #
#....   #
#########
Title: 40

           #####
          ##   ##
         ##     #
        ##  $$  #
       ## $$  $ #
       # $    $ #
####   #   $$ #####
#  ######## ##    #
#.            $$$@#
#.# ####### ##   ##
#.# #######. #$ $##
#........... #    #
##############  $ #
             ##  ##
              ####
Title: 41

     ########
  ####      ######
  #    ## $ $   @#
  # ## ##$#$ $ $##
### ......#  $$ ##
#   ......#  #   #
# # ......#$  $  #
# #$...... $$# $ #
#   ### ###$  $ ##
###  $  $  $  $ #
  #  $  $  $  $ #
  ######   ######
       #####
Title: 42

        #######
    #####  #  ####
    #   #   $    #
 #### #$$ ## ##  #
##      # #  ## ###
#  ### $#$  $  $  #
#...    # ##  #   #
#...#    @ # ### ##
#...#  ###  $  $  #
######## ##   #   #
          #########
Title: 43

 #####
 #   #
 # # #######
 #      $@######
 # $ ##$ ###   #
 # #### $    $ #
 # ##### #  #$ ####
##  #### ##$      #
#  $#  $  # ## ## #
#         # #...# #
######  ###  ...  #
     #### # #...# #
          # ### # #
          #       #
          #########
Title: 44

##### ####
#...# #  ####
#...###  $  #
#....## $  $###
##....##   $  #
###... ## $ $ #
# ##    #  $  #
#  ## # ### ####
# $ # #$  $    #
#  $ @ $    $  #
#   # $ $$ $ ###
#  ######  ###
# ##    ####
###
Title: 45

##########
#        ####
# ###### #  ##
# # $ $ $  $ #
#       #$   #
###$  $$#  ###
  #  ## # $##
  ##$#   $ @#
   #  $ $ ###
   # #   $  #
   # ##   # #
  ##  ##### #
  #         #
  #.......###
  #.......#
  #########
Title: 46

         ####
 #########  ##
##  $      $ #####
#   ## ##   ##...#
# #$$ $ $$#$##...#
# #   @   #   ...#
#  $# ###$$   ...#
# $  $$  $ ##....#
###$       #######
  #  #######
  ####
Title: 47

  #########
  #*.*#*.*#
  #.*.*.*.#
  #*.*.*.*#
  #.*.*.*.#
  #*.*.*.*#
  ###   ###
    #   #
###### ######
#           #
# $ $ $ $ $ #
## $ $ $ $ ##
 #$ $ $ $ $#
 #   $@$   #
 #  #####  #
 ####   ####
Title: 48

       ####
       #  ##
       #   ##
       # $$ ##
     ###$  $ ##
  ####    $   #
###  # #####  #
#    # #....$ #
# #   $ ....# #
#  $ # #.*..# #
###  #### ### #
  #### @$  ##$##
     ### $     #
       #  ##   #
       #########
Title: 49

      ############
     ##..    #   #
    ##..* $    $ #
   ##..*.# # # $##
   #..*.# # # $  #
####...#  #    # #
#  ## #          #
# @$ $ ###  #   ##
# $   $   # #   #
###$$   # # # # #
  #   $   # # #####
  # $# #####      #
  #$   #   #    # #
  #  ###   ##     #
  #  #      #    ##
  ####      ######
Title: 50
  </pre>
</body>
</html>

